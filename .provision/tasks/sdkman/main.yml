---
- stat:
    path: ~/.sdkman
  register: sdkman_check

- name: Install SDKMan
  shell: curl -s "https://get.sdkman.io" | bash
  when: not sdkman_check.stat.exists

- name: Setup SDKMan
  shell: source ~/.sdkman/bin/sdkman-init.sh
  when: not sdkman_check.stat.exists

- shell:
    cmd: source ~/.sdkman/bin/sdkman-init.sh && sdk list java | grep installed | grep --quiet 21.0.4-tem
  failed_when: false
  register: has_java21

- name: SDKMan Java 21.0.4-tem
  shell:
    cmd: source ~/.sdkman/bin/sdkman-init.sh && sdk install java 21.0.4-tem
  when: has_java21.rc != 0

- shell:
    cmd: source ~/.sdkman/bin/sdkman-init.sh && sdk list java | grep installed | grep --quiet 8.0.442-zulu
  failed_when: false
  register: has_java8

- name: SDKMan Java 8.0.442-zulu
  shell:
    cmd: source ~/.sdkman/bin/sdkman-init.sh && sdk install java 8.0.442-zulu
  when: has_java8.rc != 0
